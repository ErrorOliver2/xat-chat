<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>ðŸŽ­ Xat Recreation Chat</title><style>body {
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
            font-family: Arial, sans-serif;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .header h1 {
            color: #ffcc00;
            margin: 0;
        }
        
        .header p {
            color: #888;
            margin: 5px 0;
        }
        
        #userStatus {
            margin-top: 10px;
            font-size: 12px;
            color: #999;
        }
        
        #userInfo {
            margin-right: 10px;
        }
        
        #logoutBtn {
            padding: 5px 10px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 3px;
            cursor: pointer;
            display: none;
        }
        
        #logoutBtn:hover {
            background: #c82333;
        }
        
        .chat-wrapper {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 500px;
        }
        
        .loading {
            text-align: center;
            color: #ffcc00;
            font-size: 18px;
        }
        
        .error {
            text-align: center;
            color: #ff6666;
            font-size: 16px;
            padding: 20px;
            background: #2a2a2a;
            border-radius: 5px;
            margin: 20px;
        }</style><script defer="defer" src="js/vendors.a5214367fc20e0483d1f.js"></script><script defer="defer" src="js/chat.833f4f2017c90dac3743.js"></script><script defer="defer" src="js/AuthenticFlashChat.31d6cfe0d16ae931b73c.js"></script><link href="css/vendors.8eda02661e116c35eb02.css" rel="stylesheet"><link href="css/chat.33f8a17332020a8747f3.css" rel="stylesheet"></head><body><div class="header"><h1>ðŸŽ­ Xat Recreation Chat</h1><p>Authentic chat recreation with JavaScript (728x486) - No Flash Required</p><div id="userStatus"><span id="userInfo">Loading...</span> <button id="logoutBtn" onclick="logout()">Logout</button></div></div><div class="chat-wrapper"><div id="loading" class="loading">Connecting to chat server...</div><div id="error" class="error" style="display: none;"></div></div><script src="/socket.io/socket.io.js"></script><script src="/js/IxatClient.js"></script><script>let chatClient = null;
        
        function updateUserStatus() {
            const token = localStorage.getItem('authToken');
            const userData = localStorage.getItem('userData');
            const userInfo = document.getElementById('userInfo');
            const logoutBtn = document.getElementById('logoutBtn');
            
            if (token && userData) {
                try {
                    const user = JSON.parse(userData);
                    userInfo.textContent = `Logged in as: ${user.nickname} (${user.username})`;
                    logoutBtn.style.display = 'inline-block';
                } catch (e) {
                    userInfo.textContent = 'Guest user';
                    logoutBtn.style.display = 'none';
                }
            } else {
                userInfo.textContent = 'Guest user';
                logoutBtn.style.display = 'none';
            }
        }
        
        function logout() {
            // Clear authentication data
            localStorage.removeItem('authToken');
            localStorage.removeItem('userData');
            
            // Update status
            updateUserStatus();
            
            // Redirect to auth page
            window.location.href = '/auth.html';
        }
        
        function showError(message) {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('error').style.display = 'block';
            document.getElementById('error').textContent = message;
        }
        
        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }
        
        // Initialize chat client
        document.addEventListener('DOMContentLoaded', () => {
            updateUserStatus();
            
            try {
                // Create the Ixat client
                chatClient = new IxatClient({
                    serverUrl: 'http://localhost:8000',
                    roomId: 1,
                    roomName: 'Main Chat',
                    width: 728,
                    height: 486
                });
                
                // Set up event handlers
                chatClient.onConnect(() => {
                    console.log('ðŸŽ­ [CHAT] Connected to chat');
                    hideLoading();
                });
                
                chatClient.onDisconnect(() => {
                    console.log('ðŸŽ­ [CHAT] Disconnected from chat');
                    showError('Disconnected from chat server');
                });
                
                chatClient.onAuthenticated((user) => {
                    console.log('ðŸŽ­ [CHAT] Authenticated:', user);
                    // Update user status if authenticated
                    if (!user.guest) {
                        localStorage.setItem('userData', JSON.stringify(user));
                        updateUserStatus();
                    }
                });
                
                chatClient.onUserJoined((user) => {
                    console.log('ðŸŽ­ [CHAT] User joined:', user);
                });
                
                chatClient.onUserLeft((data) => {
                    console.log('ðŸŽ­ [CHAT] User left:', data);
                });
                
                chatClient.onMessage((message) => {
                    console.log('ðŸŽ­ [CHAT] Message received:', message);
                });
                
                chatClient.onError((error) => {
                    console.error('ðŸŽ­ [CHAT] Error:', error);
                    showError(`Error: ${error}`);
                });
                
            } catch (error) {
                console.error('ðŸŽ­ [CHAT] Failed to initialize chat client:', error);
                showError('Failed to initialize chat client');
            }
        });
        
        // Handle page unload
        window.addEventListener('beforeunload', () => {
            if (chatClient) {
                chatClient.disconnect();
            }
        });</script></body></html>