console.log("üé≠ [FILE] IxatClient.js loaded - Authentic Flash Recreation"),console.log("üé≠ [FILE] ================================================"),console.log("üé≠ [FILE] THIS IS THE NEW AUTHENTIC FLASH RECREATION FILE - VERSION 3 - FORCE LOADED"),console.log("üé≠ [FILE] ================================================"),console.log("üé≠ [FILE] Testing immediate execution..."),"undefined"!=typeof window?(console.log("üé≠ [FILE] Window object available"),console.log("üé≠ [FILE] Document ready state:",document.readyState)):console.log("üé≠ [FILE] No window object");class IxatClient{constructor(e,t={}){if(this.containerId=e,this.config={width:728,height:486,roomName:"Main Chat",background:"http://oi60.tinypic.com/1r6io9.jpg",...t},this.config.roomName){const e=this.config.roomName.toLowerCase();["lobby","help","test","chat","flirt","gaming","music","anime","random"].includes(e)&&(this.currentChatGroup=e)}this.elements={},this.users=new Map,this.socket=null,this.authenticated=!1,this.currentUser=null,this.powers=[],this.currentTab="chat",this.pawns=[],this.selectedPawn=null,this.games=[{id:"doodle",name:"Doodle",icon:"üé®",description:"Draw and collaborate"},{id:"hangman",name:"Hangman",icon:"üéØ",description:"Guess the word"},{id:"tictactoe",name:"Tic Tac Toe",icon:"‚≠ï",description:"Classic X and O"},{id:"quiz",name:"Quiz",icon:"‚ùì",description:"Test your knowledge"},{id:"rps",name:"Rock Paper Scissors",icon:"‚úÇÔ∏è",description:"Rock beats scissors"},{id:"dice",name:"Dice",icon:"üé≤",description:"Roll the dice"}],this.activeGame=null,this.gamePlayers=new Map,this.gameStates=new Map,this.init()}async init(){console.log("üé≠ [CLIENT] Initializing authentic Flash recreation..."),this.createAuthenticFlashUI(),this.connectToServer()}createAuthenticFlashUI(){if(console.log("üé≠ [CLIENT] Creating authentic Flash UI..."),console.log("üé≠ [CLIENT] ================================================"),console.log("üé≠ [CLIENT] THIS IS THE NEW AUTHENTIC FLASH RECREATION UI"),console.log("üé≠ [CLIENT] ================================================"),this.container=document.getElementById(this.containerId),!this.container)return void console.error("üé≠ [CLIENT] Container not found:",this.containerId);this.container.innerHTML="",this.container.style.width="728px",this.container.style.height="486px",this.container.style.position="relative",this.container.style.overflow="hidden",this.container.style.backgroundColor="#000000",this.container.style.fontFamily="Arial, sans-serif",this.container.style.fontSize="13px",this.chatGroups=[{id:"lobby",name:"Lobby",description:"Main chat room"},{id:"help",name:"Help",description:"Get help and support"},{id:"flirt",name:"Flirt",description:"Romance and dating"},{id:"test",name:"Test",description:"Testing and development"},{id:"gaming",name:"Gaming",description:"Video games discussion"},{id:"music",name:"Music",description:"Music and entertainment"},{id:"anime",name:"Anime",description:"Anime and manga"},{id:"random",name:"Random",description:"Random topics"}],this.currentChatGroup="lobby";const e=document.createElement("div");e.style.cssText=`\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            background: url("${this.config.background}") center center / cover, linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 50%, #000000 100%);\n            z-index: 1;\n        `,this.container.appendChild(e),this.elements.header=document.createElement("div"),this.elements.header.style.cssText="\n            position: absolute;\n            top: 0;\n            left: 0;\n            right: 0;\n            height: 30px;\n            background: linear-gradient(to bottom, #1a3a5a 0%, #0d2a4a 50%, #0a1f3a 100%);\n            border-bottom: 2px solid #0066cc;\n            display: flex;\n            align-items: center;\n            padding: 0 10px;\n            z-index: 10;\n            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);\n        ";const t=document.createElement("div");t.style.cssText="\n            display: flex;\n            align-items: center;\n            color: #ffffff;\n            font-size: 13px;\n            font-weight: bold;\n            margin-right: 20px;\n            text-shadow: 1px 1px 1px rgba(0, 0, 0, 0.8);\n        ",t.innerHTML=`\n            <span style="font-size: 16px; margin-right: 8px;">ü™ê</span>\n            ${this.config.roomName||"Main Chat"}\n        `,this.elements.header.appendChild(t),[{icon:"üë•",label:"groups",color:"#ff4444"},{icon:"üõçÔ∏è",label:"store",color:"#ffcc00"},{icon:"ü™ê",label:"xat",color:"#0066cc"},{icon:"üë•",label:"group",color:"#00cc00"},{icon:"üë§",label:"account",color:"#00cc00"},{icon:"‚¨ú",label:"",color:"#0066cc"},{icon:"üåê",label:"",color:"#0066cc"}].forEach(e=>{const t=document.createElement("div");t.style.cssText="\n                display: flex;\n                align-items: center;\n                margin-left: 15px;\n                cursor: pointer;\n                padding: 2px 6px;\n                border-radius: 3px;\n                transition: all 0.2s ease;\n            ",t.innerHTML=`\n                <span style="font-size: 14px; margin-right: 4px;">${e.icon}</span>\n                <span style="color: #ffffff; font-size: 11px; font-weight: bold;">${e.label}</span>\n            `,t.onmouseover=()=>{t.style.background="rgba(255, 255, 255, 0.1)"},t.onmouseout=()=>{t.style.background="transparent"},this.elements.header.appendChild(t)}),this.container.appendChild(this.elements.header),this.elements.leftSidebar=document.createElement("div"),this.elements.leftSidebar.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            width: 120px;\n            bottom: 40px;\n            background: linear-gradient(to bottom, #2a2a2a 0%, #1a1a1a 100%);\n            border-right: 2px solid #444444;\n            display: flex;\n            flex-direction: column;\n            padding: 10px;\n            z-index: 5;\n        ";const n=document.createElement("div");n.style.cssText="\n            color: #ffffff;\n            font-size: 12px;\n            font-weight: bold;\n            text-align: center;\n            margin-bottom: 10px;\n            padding: 5px;\n            background: #0066cc;\n            border-radius: 3px;\n        ",n.textContent="üéÆ GAMES",this.elements.leftSidebar.appendChild(n),[{icon:"üé®",name:"Doodle",id:"doodle"},{icon:"üéØ",name:"Hangman",id:"hangman"},{icon:"‚≠ï",name:"Tic Tac Toe",id:"tictactoe"},{icon:"‚ùì",name:"Quiz",id:"quiz"},{icon:"‚úÇÔ∏è",name:"RPS",id:"rps"},{icon:"üé≤",name:"Dice",id:"dice"}].forEach(e=>{const t=document.createElement("div");t.style.cssText="\n                background: #333333;\n            border: 1px solid #444444;\n                color: #ffffff;\n                padding: 8px;\n                margin-bottom: 5px;\n                font-size: 11px;\n                font-weight: bold;\n                cursor: pointer;\n                text-align: center;\n                border-radius: 3px;\n                transition: all 0.2s ease;\n            ",t.innerHTML=`\n                <div style="font-size: 16px; margin-bottom: 3px;">${e.icon}</div>\n                <div>${e.name}</div>\n            `,t.onmouseover=()=>{t.style.background="#444444",t.style.borderColor="#0066cc"},t.onmouseout=()=>{t.style.background="#333333",t.style.borderColor="#444444"},t.onclick=()=>this.startGame({id:e.id,name:e.name}),this.elements.leftSidebar.appendChild(t)});const o=document.createElement("div");o.style.cssText="\n            color: #ffffff;\n            font-size: 12px;\n            font-weight: bold;\n            text-align: center;\n            margin: 15px 0 10px 0;\n            padding: 5px;\n            background: #28a745;\n            border-radius: 3px;\n        ",o.textContent="üí¨ CHATS",this.elements.leftSidebar.appendChild(o),this.chatGroups.forEach(e=>{const t=document.createElement("div");t.style.cssText=`\n                background: ${e.id===this.currentChatGroup?"#28a745":"#333333"};\n                border: 1px solid #444444;\n            color: #ffffff;\n                padding: 6px 8px;\n                margin-bottom: 3px;\n                font-size: 10px;\n                font-weight: bold;\n                cursor: pointer;\n                text-align: center;\n                border-radius: 3px;\n                transition: all 0.2s ease;\n            `,t.textContent=e.name,t.onmouseover=()=>{e.id!==this.currentChatGroup&&(t.style.background="#444444",t.style.borderColor="#28a745")},t.onmouseout=()=>{e.id!==this.currentChatGroup&&(t.style.background="#333333",t.style.borderColor="#444444")},t.onclick=()=>this.switchChatGroup(e.id),this.elements.leftSidebar.appendChild(t)}),this.container.appendChild(this.elements.leftSidebar),this.elements.mainChatArea=document.createElement("div"),this.elements.mainChatArea.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 120px;\n            right: 0;\n            bottom: 40px;\n            background: #2a2a2a;\n            border: 2px solid #666666;\n            display: flex;\n            z-index: 5;\n        ";const a=document.createElement("div");a.style.cssText="\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            padding: 10px;\n        ",this.elements.chatArea=document.createElement("div"),this.elements.chatArea.style.cssText="\n            flex: 1;\n            background: #1a1a1a;\n            border: 1px solid #444444;\n            margin-bottom: 10px;\n            overflow-y: auto;\n            padding: 10px;\n            font-family: Arial, sans-serif;\n            font-size: 12px;\n            color: #ffffff;\n            -webkit-user-select: text;\n            -moz-user-select: text;\n            -ms-user-select: text;\n            user-select: text;\n        ",a.appendChild(this.elements.chatArea);const s=document.createElement("div");s.style.cssText="\n            display: flex;\n            align-items: center;\n            background: #1a1a1a;\n            border: 1px solid #444444;\n            padding: 5px;\n        ";const i=document.createElement("span");i.style.cssText="\n            color: #ffffff;\n            font-size: 14px;\n            margin-right: 8px;\n        ",i.textContent="üí¨",s.appendChild(i);const r=document.createElement("span");r.style.cssText="\n            color: #ffffff;\n            font-size: 12px;\n            margin-right: 8px;\n        ",r.textContent=this.config.roomName||"Main Chat",s.appendChild(r),this.elements.messageInput=document.createElement("input"),this.elements.messageInput.type="text",this.elements.messageInput.placeholder="Type your message...",this.elements.messageInput.style.cssText="\n            flex: 1;\n            background: #000000;\n            border: 1px solid #666666;\n            color: #ffffff;\n            padding: 5px 8px;\n            font-size: 12px;\n            outline: none;\n            -webkit-user-select: text;\n            -moz-user-select: text;\n            -ms-user-select: text;\n            user-select: text;\n        ",s.appendChild(this.elements.messageInput),a.appendChild(s);const l=document.createElement("div");l.style.cssText="\n            display: flex;\n            align-items: center;\n            margin-top: 5px;\n            gap: 3px;\n        ",["üòä","üòÇ","üòç","üòé","üò¢","üò°","üò¥","üòá","ü§î","üòã","üé±","üí∞","üéµ"].forEach(e=>{const t=document.createElement("span");t.style.cssText="\n                font-size: 16px;\n                cursor: pointer;\n                padding: 2px;\n                border-radius: 2px;\n                transition: all 0.2s ease;\n            ",t.textContent=e,t.onmouseover=()=>{t.style.background="rgba(255, 255, 255, 0.2)"},t.onmouseout=()=>{t.style.background="transparent"},t.onclick=()=>this.insertSmiley(e),l.appendChild(t)}),a.appendChild(l),this.elements.mainChatArea.appendChild(a);const d=document.createElement("div");d.style.cssText="\n            width: 200px;\n            display: flex;\n            flex-direction: column;\n            background: #1a1a1a;\n            border-left: 1px solid #444444;\n        ";const c=document.createElement("div");c.style.cssText="\n            display: flex;\n            flex-direction: column;\n            padding: 5px;\n        ",["VIP","Club","Chum"].forEach(e=>{const t=document.createElement("div");t.style.cssText="\n                background: #2a2a2a;\n                border: 1px solid #444444;\n                color: #ffffff;\n                padding: 5px 8px;\n                margin-bottom: 2px;\n                font-size: 11px;\n                font-weight: bold;\n                cursor: pointer;\n                text-align: center;\n            ",t.textContent=e,t.onclick=()=>this.switchRankPool(e),c.appendChild(t)}),d.appendChild(c);const p=document.createElement("div");p.style.cssText="\n            display: flex;\n            margin-top: 10px;\n        ";const f=document.createElement("div");f.style.cssText="\n            flex: 1;\n            background: #2a2a2a;\n            color: #ffffff;\n            padding: 5px;\n            text-align: center;\n            font-size: 11px;\n            font-weight: bold;\n            border: 1px solid #444444;\n            cursor: pointer;\n        ",f.textContent="Visitors",p.appendChild(f);const m=document.createElement("div");m.style.cssText="\n            flex: 1;\n            background: #1a1a1a;\n            color: #cccccc;\n            padding: 5px;\n            text-align: center;\n            font-size: 11px;\n            font-weight: bold;\n            border: 1px solid #444444;\n            cursor: pointer;\n        ",m.textContent="Friends",p.appendChild(m),d.appendChild(p),this.elements.userList=document.createElement("div"),this.elements.userList.style.cssText="\n            flex: 1;\n            background: #1a1a1a;\n            border-top: 1px solid #444444;\n            padding: 5px;\n            overflow-y: auto;\n            font-family: Arial, sans-serif;\n            font-size: 11px;\n        ",d.appendChild(this.elements.userList);const g=document.createElement("div");g.style.cssText="\n            display: flex;\n            flex-direction: column;\n            padding: 5px;\n            gap: 3px;\n        ";const u=document.createElement("div");u.style.cssText="\n            background: #2a2a2a;\n            border: 1px solid #444444;\n            color: #ffffff;\n            padding: 5px 8px;\n            font-size: 11px;\n            font-weight: bold;\n            cursor: pointer;\n            text-align: center;\n        ",u.textContent="Edit Your Chat",g.appendChild(u);const x=document.createElement("div");x.style.cssText="\n            background: #2a2a2a;\n            border: 1px solid #444444;\n            color: #ffffff;\n            padding: 5px 8px;\n            font-size: 11px;\n            font-weight: bold;\n            cursor: pointer;\n            text-align: center;\n        ",x.textContent="Sign Out",g.appendChild(x),d.appendChild(g),this.elements.mainChatArea.appendChild(d),this.container.appendChild(this.elements.mainChatArea),this.elements.bottomBar=document.createElement("div"),this.elements.bottomBar.style.cssText="\n            position: absolute;\n            bottom: 0;\n            left: 0;\n            right: 0;\n            height: 40px;\n            background: linear-gradient(to bottom, #1a3a5a 0%, #0d2a4a 50%, #0a1f3a 100%);\n            border-top: 2px solid #0066cc;\n            display: flex;\n            align-items: center;\n            padding: 0 10px;\n            z-index: 10;\n        ";const h=document.createElement("div");h.style.cssText="\n            color: #ffffff;\n            font-size: 12px;\n            font-weight: bold;\n            margin-right: 15px;\n        ",h.textContent="CELEBRATE power",this.elements.bottomBar.appendChild(h),["üëç","üéâ","üèÅ","üé©","üéì","üé∫","üéä","üéà"].forEach(e=>{const t=document.createElement("span");t.style.cssText="\n                font-size: 16px;\n                margin-right: 8px;\n                cursor: pointer;\n                padding: 2px;\n                border-radius: 2px;\n            transition: all 0.2s ease;\n        ",t.textContent=e,t.onmouseover=()=>{t.style.background="rgba(255, 255, 255, 0.1)"},t.onmouseout=()=>{t.style.background="transparent"},this.elements.bottomBar.appendChild(t)}),this.container.appendChild(this.elements.bottomBar),this.elements.messageInput.addEventListener("keypress",e=>{"Enter"===e.key&&this.sendMessage()}),console.log("üé≠ [CLIENT] Authentic Flash UI created successfully"),console.log("üé≠ [CLIENT] Container children count:",this.container.children.length),console.log("üé≠ [CLIENT] Header element exists:",!!this.elements.header),console.log("üé≠ [CLIENT] Header children count:",this.elements.header.children.length),console.log("üé≠ [CLIENT] Final container HTML:",this.container.innerHTML.substring(0,500)+"...")}setupEventListeners(){this.elements.messageInput.addEventListener("keypress",e=>{"Enter"===e.key&&this.sendMessage()}),this.elements.messageInput.addEventListener("focus",()=>{this.elements.messageInput.style.borderColor="#0066cc",this.elements.messageInput.style.boxShadow="inset 0 1px 3px rgba(0, 0, 0, 0.5), 0 0 5px rgba(0, 102, 204, 0.3)"}),this.elements.messageInput.addEventListener("blur",()=>{this.elements.messageInput.style.borderColor="#555555",this.elements.messageInput.style.boxShadow="inset 0 1px 3px rgba(0, 0, 0, 0.5)"}),this.elements.sendButton.addEventListener("click",()=>{this.sendMessage()}),this.elements.sendButton.addEventListener("mouseover",()=>{this.elements.sendButton.style.background="linear-gradient(to bottom, #0077ee 0%, #0066cc 50%, #0052a3 100%)",this.elements.sendButton.style.transform="translateY(-1px)",this.elements.sendButton.style.boxShadow="0 3px 6px rgba(0, 0, 0, 0.4)"}),this.elements.sendButton.addEventListener("mouseout",()=>{this.elements.sendButton.style.background="linear-gradient(to bottom, #0066cc 0%, #0052a3 50%, #003d7a 100%)",this.elements.sendButton.style.transform="translateY(0)",this.elements.sendButton.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.3)"}),this.elements.getChatButton.addEventListener("click",()=>{window.open("/groups.html","_blank")}),this.elements.getChatButton.addEventListener("mouseover",()=>{this.elements.getChatButton.style.background="linear-gradient(to bottom, #444444 0%, #333333 50%, #222222 100%)",this.elements.getChatButton.style.transform="translateY(-1px)",this.elements.getChatButton.style.boxShadow="0 3px 6px rgba(0, 0, 0, 0.4)"}),this.elements.getChatButton.addEventListener("mouseout",()=>{this.elements.getChatButton.style.background="linear-gradient(to bottom, #333333 0%, #222222 50%, #111111 100%)",this.elements.getChatButton.style.transform="translateY(0)",this.elements.getChatButton.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.3)"}),this.elements.signOutButton.addEventListener("click",()=>{confirm("Are you sure you want to sign out?")&&(localStorage.removeItem("authToken"),localStorage.removeItem("userData"),window.location.href="/auth.html")}),this.elements.signOutButton.addEventListener("mouseover",()=>{this.elements.signOutButton.style.background="linear-gradient(to bottom, #dd4444 0%, #cc3333 50%, #bb2222 100%)",this.elements.signOutButton.style.transform="translateY(-1px)",this.elements.signOutButton.style.boxShadow="0 3px 6px rgba(0, 0, 0, 0.4)"}),this.elements.signOutButton.addEventListener("mouseout",()=>{this.elements.signOutButton.style.background="linear-gradient(to bottom, #cc3333 0%, #aa2222 50%, #881111 100%)",this.elements.signOutButton.style.transform="translateY(0)",this.elements.signOutButton.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.3)"}),this.elements.userList.addEventListener("click",e=>{const t=e.target.closest(".user-item");if(t){const e=t.dataset.userId;e&&this.showUserProfile(e)}})}switchTab(e){switch(console.log("üé≠ [CLIENT] Switching to tab:",e),this.elements.header.querySelectorAll("div").forEach((t,n)=>{if(n<8){const n=t.textContent.toLowerCase().includes(e);t.style.background=n?"#0066ff":"transparent",t.style.color=n?"#ffffff":"#cccccc"}}),e){case"chat":this.showChatTab();break;case"smilies":this.showSmiliesTab();break;case"radio":this.showRadioTab();break;case"8ball":this.show8BallTab();break;case"friends":this.showFriendsTab();break;case"visitors":this.showVisitorsTab();break;case"getchat":this.showGetChatTab();break;case"signin":this.showSignInTab()}}showChatTab(){this.elements.chatArea.style.display="block",this.elements.userList.style.display="block"}showSmiliesTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            overflow-y: auto;\n            z-index: 5;\n        ",e.innerHTML='\n            <h3 style="color: #ffcc00; margin-bottom: 20px;">üòä Smilies</h3>\n            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 5px;">\n                <button onclick="window.ixatClient.insertSmiley(\'(hi)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(hi)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(bye)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(bye)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(yes)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(yes)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(no)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(no)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(cool)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(cool)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(love)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(love)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(kiss)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(kiss)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(hug)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(hug)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(cry)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(cry)</button>\n                <button onclick="window.ixatClient.insertSmiley(\'(laugh)\')" style="padding: 5px; background: #2a2a2a; border: 1px solid #444; color: white; cursor: pointer;">(laugh)</button>\n            </div>\n        ';const t=document.querySelector(".smilies-panel");t&&t.remove(),e.className="smilies-panel",this.container.appendChild(e)}showRadioTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            z-index: 5;\n        ",e.innerHTML='\n            <h3 style="color: #ffcc00; margin-bottom: 20px;">üéµ Radio</h3>\n            <div style="margin-bottom: 20px;">\n                <label style="color: white; display: block; margin-bottom: 5px;">Radio URL:</label>\n                <input type="text" id="radioUrl" placeholder="http://relay.181.fm:8128" style="width: 100%; padding: 8px; background: #2a2a2a; border: 1px solid #444; color: white; border-radius: 3px;">\n            </div>\n            <div>\n                <button onclick="window.ixatClient.playRadio()" style="padding: 10px 20px; background: #0066ff; color: white; border: none; border-radius: 3px; cursor: pointer; margin-right: 10px;">‚ñ∂Ô∏è Play</button>\n                <button onclick="window.ixatClient.stopRadio()" style="padding: 10px 20px; background: #dc3545; color: white; border: none; border-radius: 3px; cursor: pointer;">‚èπÔ∏è Stop</button>\n            </div>\n        ';const t=document.querySelector(".radio-panel");t&&t.remove(),e.className="radio-panel",this.container.appendChild(e)}show8BallTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            z-index: 5;\n        ",e.innerHTML='\n            <div style="text-align: center;">\n                <div style="width: 200px; height: 200px; background: radial-gradient(circle, #000, #333); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; border: 3px solid #666;">\n                    <div id="8ballAnswer" style="color: white; font-size: 16px; text-align: center; padding: 20px;">Ask the Magic 8-Ball</div>\n                </div>\n                <input type="text" id="8ballQuestion" placeholder="Ask a question..." style="width: 300px; padding: 10px; background: #2a2a2a; border: 1px solid #444; color: white; border-radius: 3px; margin-bottom: 10px;">\n                <br>\n                <button onclick="window.ixatClient.ask8Ball()" style="padding: 10px 20px; background: #0066ff; color: white; border: none; border-radius: 3px; cursor: pointer;">Ask 8-Ball</button>\n            </div>\n        ';const t=document.querySelector(".8ball-panel");t&&t.remove(),e.className="8ball-panel",this.container.appendChild(e)}showFriendsTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            z-index: 5;\n        ",e.innerHTML='\n            <h3 style="color: #ffcc00; margin-bottom: 20px;">üë• Friends</h3>\n            <div style="color: #ccc; text-align: center; padding: 20px;">Friends list coming soon...</div>\n        ';const t=document.querySelector(".friends-panel");t&&t.remove(),e.className="friends-panel",this.container.appendChild(e)}showVisitorsTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            z-index: 5;\n        ",e.innerHTML='\n            <h3 style="color: #ffcc00; margin-bottom: 20px;">üëÄ Visitors</h3>\n            <div style="color: #ccc; text-align: center; padding: 20px;">Visitor statistics coming soon...</div>\n        ';const t=document.querySelector(".visitors-panel");t&&t.remove(),e.className="visitors-panel",this.container.appendChild(e)}showGetChatTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            z-index: 5;\n        ",e.innerHTML='\n            <h3 style="color: #ffcc00; margin-bottom: 20px;">üè† Get a Chat</h3>\n            <div style="color: #ccc; text-align: center; padding: 20px;">Chat creation coming soon...</div>\n        ';const t=document.querySelector(".getchat-panel");t&&t.remove(),e.className="getchat-panel",this.container.appendChild(e)}showSignInTab(){this.elements.chatArea.style.display="none",this.elements.userList.style.display="none";const e=document.createElement("div");e.style.cssText="\n            position: absolute;\n            top: 30px;\n            left: 0;\n            right: 0;\n            bottom: 60px;\n            background: rgba(0, 0, 0, 0.9);\n            padding: 20px;\n            z-index: 5;\n        ",e.innerHTML='\n            <h3 style="color: #ffcc00; margin-bottom: 20px;">üîê Sign In/Out</h3>\n            <div style="color: #ccc; text-align: center; padding: 20px;">Authentication coming soon...</div>\n        ';const t=document.querySelector(".signin-panel");t&&t.remove(),e.className="signin-panel",this.container.appendChild(e)}connectToServer(){console.log("üé≠ [CLIENT] Connecting to server..."),this.socket=io(),this.socket.on("connect",()=>{console.log("üé≠ [CLIENT] Connected to server"),this.authenticate()}),this.socket.on("authenticated",e=>{console.log("üé≠ [CLIENT] Authenticated:",e),this.user=e.user,this.authenticated=!0,this.joinRoom()}),this.socket.on("userList",e=>{console.log("üé≠ [CLIENT] User list received:",e),this.updateUserList(e.users)}),this.socket.on("message",e=>{console.log("üé≠ [CLIENT] Message received:",e),this.addMessage(e)})}authenticate(){const e=localStorage.getItem("authToken");if(e&&"undefined"!==e)this.socket.emit("authenticate",{token:e});else{const e="Guest"+Math.floor(1e3*Math.random());this.socket.emit("authenticate",{guest:!0,nickname:e})}}joinRoom(){this.authenticated&&this.socket.emit("joinRoom",{roomName:this.config.roomName})}sendMessage(){if(!this.authenticated)return;const e=this.elements.messageInput.value.trim();e&&(this.socket.emit("message",{message:e}),this.elements.messageInput.value="")}insertSmiley(e){const t=this.elements.messageInput,n=t.selectionStart,o=t.selectionEnd,a=t.value;t.value=a.substring(0,n)+e+a.substring(o),t.selectionStart=t.selectionEnd=n+e.length,t.focus()}startPrivateChat(e){console.log("üé≠ [CLIENT] Starting private chat with:",e),this.elements.privateChats||(this.elements.privateChats={});const t=`pm_${e.id}`;this.elements.privateChats[t]||this.createPrivateChatWindow(e,t),this.elements.privateChats[t].style.display="flex"}createPrivateChatWindow(e,t){const n=document.createElement("div");n.style.cssText="\n            position: fixed;\n            top: 50%;\n            left: 50%;\n            transform: translate(-50%, -50%);\n            width: 400px;\n            height: 300px;\n            background: #2a2a2a;\n            border: 1px solid #444444;\n            border-radius: 4px;\n            color: #ffffff;\n            font-family: Arial, sans-serif;\n            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);\n            display: none;\n            flex-direction: column;\n            z-index: 1001;\n        ",n.innerHTML=`\n            <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                <span style="font-size: 14px; font-weight: bold;">Private Chat with ${e.nickname||e.username}</span>\n                <span id="close_${t}" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n            </div>\n            \n            <div id="pm_messages_${t}" style="flex: 1; padding: 10px; overflow-y: auto; background: #1a1a1a; margin: 5px; border: 1px solid #444444; border-radius: 2px;">\n                \x3c!-- Private messages will appear here --\x3e\n            </div>\n            \n            <div style="padding: 10px; display: flex; gap: 5px;">\n                <input id="pm_input_${t}" type="text" placeholder="Type your message..." style="flex: 1; background: #3a3a3a; border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 12px; outline: none;">\n                <button id="pm_send_${t}" style="background: #0066cc; border: none; color: #ffffff; padding: 8px 12px; cursor: pointer; font-size: 12px;">Send</button>\n            </div>\n        `,document.body.appendChild(n),this.elements.privateChats[t]=n,document.getElementById(`close_${t}`).onclick=()=>{n.style.display="none"},document.getElementById(`pm_send_${t}`).onclick=()=>{this.sendPrivateMessageToUser(e,t)},document.getElementById(`pm_input_${t}`).onkeypress=n=>{"Enter"===n.key&&this.sendPrivateMessageToUser(e,t)},this.privateMessages||(this.privateMessages={}),this.privateMessages[t]=[]}sendPrivateMessageToUser(e,t){const n=document.getElementById(`pm_input_${t}`),o=n.value.trim();o&&(this.addPrivateMessage(t,{sender:this.currentUser?.nickname||"You",message:o,timestamp:(new Date).toLocaleTimeString()}),this.sendPrivateMessagePacket(e.id,o),n.value="")}addPrivateMessage(e,t){const n=document.getElementById(`pm_messages_${e}`),o=document.createElement("div");o.style.cssText="\n            margin-bottom: 8px;\n            padding: 5px;\n            background: #2a2a2a;\n            border-radius: 3px;\n        ",o.innerHTML=`\n            <div style="font-size: 11px; color: #888888; margin-bottom: 2px;">${t.timestamp}</div>\n            <div style="font-weight: bold; color: #0066cc; margin-bottom: 2px;">${t.sender}</div>\n            <div style="color: #ffffff; word-wrap: break-word;">${t.message}</div>\n        `,n.appendChild(o),n.scrollTop=n.scrollHeight,this.privateMessages[e].push(t),this.privateMessages[e].length>25&&this.privateMessages[e].shift()}sendPrivateMessagePacket(e,t){const n={type:"private_message",targetUserId:e,message:t,sender:this.currentUser?.id||"guest"};console.log("üé≠ [CLIENT] Sending private message packet:",n),this.socket&&this.socket.emit("private_message",n)}sendPrivateMessage(e){console.log("üé≠ [CLIENT] Sending private message to:",e);const t=prompt(`Send private message to ${e.nickname||e.username}:`);t&&t.trim()&&(this.sendPrivateMessagePacket(e.id,t.trim()),alert(`Private message sent to ${e.nickname||e.username}!`))}addAsFriend(e){console.log("üé≠ [CLIENT] Adding as friend:",e),this.socket&&this.socket.emit("add_friend",{targetUserId:e.id}),alert(`Friend request sent to ${e.nickname||e.username}!`)}ignoreUser(e){console.log("üé≠ [CLIENT] Ignoring user:",e),this.socket&&this.socket.emit("ignore_user",{targetUserId:e.id}),alert(`You are now ignoring ${e.nickname||e.username}!`)}kickUser(e){console.log("üé≠ [CLIENT] Kicking user:",e);const t=prompt(`Enter kick reason for ${e.nickname||e.username}:`);this.socket&&this.socket.emit("kick_user",{targetUserId:e.id,reason:t||"No reason provided"}),alert(`${e.nickname||e.username} has been kicked!`)}banUser(e){console.log("üé≠ [CLIENT] Banning user:",e);const t=prompt(`Enter ban reason for ${e.nickname||e.username}:`),n=prompt("Enter ban duration in hours (0 for permanent):");this.socket&&this.socket.emit("ban_user",{targetUserId:e.id,reason:t||"No reason provided",duration:parseInt(n)||0}),alert(`${e.nickname||e.username} has been banned!`)}makeUserGuest(e){console.log("üé≠ [CLIENT] Making user guest:",e),this.socket&&this.socket.emit("change_rank",{targetUserId:e.id,newRank:0}),alert(`${e.nickname||e.username} is now a guest!`)}makeUserMember(e){console.log("üé≠ [CLIENT] Making user member:",e),this.socket&&this.socket.emit("change_rank",{targetUserId:e.id,newRank:1}),alert(`${e.nickname||e.username} is now a member!`)}makeUserModerator(e){console.log("üé≠ [CLIENT] Making user moderator:",e);const t=prompt("Enter moderator duration in hours (0 for permanent):");this.socket&&this.socket.emit("change_rank",{targetUserId:e.id,newRank:2,duration:parseInt(t)||0}),alert(`${e.nickname||e.username} is now a moderator!`)}makeUserOwner(e){console.log("üé≠ [CLIENT] Making user owner:",e);const t=prompt("Enter owner duration in hours (0 for permanent):");this.socket&&this.socket.emit("change_rank",{targetUserId:e.id,newRank:3,duration:parseInt(t)||0}),alert(`${e.nickname||e.username} is now an owner!`)}divorceUser(e){console.log("üé≠ [CLIENT] Divorcing user:",e);const t=window.confirm(`Are you sure you want to divorce ${e.nickname||e.username}?`);t&&this.socket&&this.socket.emit("divorce_user",{targetUserId:e.id}),t&&alert(`You have divorced ${e.nickname||e.username}!`)}transferOwnership(e){console.log("üé≠ [CLIENT] Transferring ownership to:",e);const t=window.confirm(`Are you sure you want to transfer ownership to ${e.nickname||e.username}? This action cannot be undone!`);t&&this.socket&&this.socket.emit("transfer_ownership",{targetUserId:e.id}),t&&alert(`Ownership transferred to ${e.nickname||e.username}!`)}showUserPowers(e){console.log("üé≠ [CLIENT] Showing user powers:",e),alert(`Powers window for ${e.nickname||e.username} - Coming soon!`)}handleRegularProfileAction(e,t){switch(console.log("üé≠ [CLIENT] Regular profile action:",e,"for user:",t),e){case"privatechat":this.startPrivateChat(t);break;case"privatemessage":this.sendPrivateMessage(t);break;case"addfriend":this.addAsFriend(t);break;case"ignore":this.ignoreUser(t);break;case"marry":this.marryUser(t);break;case"transfer":this.transferToUser(t);break;case"powers":this.showUserPowers(t);break;case"gifts":this.showUserGifts(t)}}marryUser(e){console.log("üé≠ [CLIENT] Marrying user:",e);const t=window.confirm(`Do you want to marry ${e.nickname||e.username}?`);t&&this.socket&&this.socket.emit("marry_user",{targetUserId:e.id}),t&&alert(`You are now married to ${e.nickname||e.username}!`)}transferToUser(e){console.log("üé≠ [CLIENT] Transferring to user:",e);const t=prompt(`Enter amount to transfer to ${e.nickname||e.username}:`),n=prompt("Enter transfer type (xats/powers):");t&&n&&this.socket&&this.socket.emit("transfer_to_user",{targetUserId:e.id,amount:parseInt(t),type:n}),t&&n&&alert(`Transferred ${t} ${n} to ${e.nickname||e.username}!`)}showUserGifts(e){console.log("üé≠ [CLIENT] Showing user gifts:",e),alert(`Gifts window for ${e.nickname||e.username} - Coming soon!`)}loadPawns(){console.log("üé≠ [CLIENT] Loading pawns..."),this.pawns=[{hex:"000000",name:"Black",color:"#000000"},{hex:"FFFFFF",name:"White",color:"#FFFFFF"},{hex:"FF0000",name:"Red",color:"#FF0000"},{hex:"00FF00",name:"Green",color:"#00FF00"},{hex:"0000FF",name:"Blue",color:"#0000FF"},{hex:"FFFF00",name:"Yellow",color:"#FFFF00"},{hex:"FF00FF",name:"Magenta",color:"#FF00FF"},{hex:"00FFFF",name:"Cyan",color:"#00FFFF"},{hex:"FFA500",name:"Orange",color:"#FFA500"},{hex:"800080",name:"Purple",color:"#800080"},{hex:"FFC0CB",name:"Pink",color:"#FFC0CB"},{hex:"A52A2A",name:"Brown",color:"#A52A2A"},{hex:"808080",name:"Gray",color:"#808080"},{hex:"FFD700",name:"Gold",color:"#FFD700"},{hex:"C0C0C0",name:"Silver",color:"#C0C0C0"},{hex:"FF4500",name:"Orange Red",color:"#FF4500"}],console.log("üé≠ [CLIENT] Loaded pawns:",this.pawns.length)}showPawnSelector(){console.log("üé≠ [CLIENT] Showing pawn selector"),this.elements.pawnSelector||(this.elements.pawnSelector=document.createElement("div"),this.elements.pawnSelector.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.pawnSelector.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 8px; width: 500px; max-height: 80vh; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5); overflow: hidden;">\n                    \x3c!-- Title Bar --\x3e\n                    <div style="background: #1a1a1a; padding: 15px 20px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span style="font-size: 18px; font-weight: bold;">üé® Select Your Pawn</span>\n                        <span id="closePawnSelector" style="color: #ffffff; font-size: 20px; cursor: pointer; font-weight: bold;">√ó</span>\n                    </div>\n                    \n                    \x3c!-- Custom Hex Input --\x3e\n                    <div style="padding: 15px 20px; border-bottom: 1px solid #444444; background: #1a1a1a;">\n                        <div style="display: flex; gap: 10px; align-items: center;">\n                            <span style="font-size: 14px;">Custom Color:</span>\n                            <input type="text" id="customPawnHex" placeholder="#000000" style="width: 100px; padding: 8px; border: 1px solid #444444; border-radius: 4px; background: #333333; color: #ffffff; font-family: monospace;">\n                            <button id="applyCustomPawn" style="background: #0066cc; border: none; color: #ffffff; padding: 8px 15px; border-radius: 4px; cursor: pointer; font-size: 12px;">Apply</button>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Pawns Grid --\x3e\n                    <div id="pawnsGrid" style="padding: 20px; max-height: 300px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 10px;">\n                        \x3c!-- Pawns will be loaded here --\x3e\n                    </div>\n                    \n                    \x3c!-- Current Selection --\x3e\n                    <div style="padding: 15px 20px; border-top: 1px solid #444444; background: #1a1a1a;">\n                        <div style="display: flex; justify-content: space-between; align-items: center;">\n                            <span>Selected: <span id="selectedPawnName">None</span></span>\n                            <button id="applyPawn" style="background: #0066cc; border: none; color: #ffffff; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold;">Apply Pawn</button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.pawnSelector),document.getElementById("closePawnSelector").onclick=()=>{this.elements.pawnSelector.style.display="none"},this.elements.pawnSelector.onclick=e=>{e.target===this.elements.pawnSelector&&(this.elements.pawnSelector.style.display="none")},document.querySelectorAll(".pawn-category").forEach(e=>{e.onclick=e=>{const t=e.target.dataset.category;this.filterPawns(t),document.querySelectorAll(".pawn-category").forEach(e=>{e.style.background="#333333"}),e.target.style.background="#0066cc"}}),document.getElementById("applyPawn").onclick=()=>{this.selectedPawn&&this.applyPawn(this.selectedPawn)}),this.loadPawns(),this.displayPawns(),this.elements.pawnSelector.style.display="flex"}displayPawns(){const e=document.getElementById("pawnsGrid");e.innerHTML="",this.pawns.forEach(t=>{const n=document.createElement("div");n.style.cssText="\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                padding: 8px;\n                border: 2px solid #444444;\n                border-radius: 6px;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                background: #333333;\n            ",n.innerHTML=`\n                <div style="width: 40px; height: 40px; background: ${t.color}; border: 1px solid #666666; border-radius: 4px; margin-bottom: 5px;"></div>\n                <span style="font-size: 9px; text-align: center; color: #cccccc;">${t.name}</span>\n            `,n.onclick=()=>{this.selectPawn(t),document.querySelectorAll("#pawnsGrid > div").forEach(e=>{e.style.borderColor="#444444",e.style.background="#333333"}),n.style.borderColor="#0066cc",n.style.background="#1a1a1a"},n.onmouseover=()=>{this.selectedPawn?.hex!==t.hex&&(n.style.borderColor="#666666",n.style.background="#444444")},n.onmouseout=()=>{this.selectedPawn?.hex!==t.hex&&(n.style.borderColor="#444444",n.style.background="#333333")},e.appendChild(n)}),document.getElementById("applyCustomPawn").onclick=()=>{const e=document.getElementById("customPawnHex").value.replace("#","");if(6===e.length&&/^[0-9A-Fa-f]{6}$/.test(e)){const t={hex:e.toUpperCase(),name:"Custom",color:`#${e}`};this.selectPawn(t),this.applyPawn(t)}else alert("Please enter a valid 6-character hex color (e.g., #FF0000)")}}selectPawn(e){this.selectedPawn=e,document.getElementById("selectedPawnName").textContent=`${e.name} (#${e.hex})`,console.log("üé≠ [CLIENT] Selected pawn:",e)}applyPawn(e){console.log("üé≠ [CLIENT] Applying pawn:",e),this.socket&&this.socket.emit("change_pawn",{pawnHex:e.hex}),this.currentUser&&(this.currentUser.pawn=e.hex),this.elements.pawnSelector.style.display="none",alert(`Pawn changed to ${e.name} (#${e.hex})!`)}loadGames(){console.log("üé≠ [CLIENT] Loading games..."),this.games=[{id:"doodle",name:"Doodle",description:"Draw and guess game",icon:"üé®"},{id:"hangman",name:"Hangman",description:"Word guessing game",icon:"üéØ"},{id:"tictactoe",name:"Tic Tac Toe",description:"Classic X and O game",icon:"‚≠ï"},{id:"quiz",name:"Quiz",description:"Trivia questions",icon:"‚ùì"},{id:"rps",name:"Rock Paper Scissors",description:"Rock, Paper, Scissors",icon:"‚úÇÔ∏è"},{id:"dice",name:"Dice",description:"Roll virtual dice",icon:"üé≤"}],console.log("üé≠ [CLIENT] Loaded games:",this.games.length)}showGamesMenu(){console.log("üé≠ [CLIENT] Showing games menu"),this.elements.gamesMenu||(this.elements.gamesMenu=document.createElement("div"),this.elements.gamesMenu.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.gamesMenu.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 8px; width: 600px; max-height: 80vh; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5); overflow: hidden;">\n                    \x3c!-- Title Bar --\x3e\n                    <div style="background: #1a1a1a; padding: 15px 20px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span style="font-size: 18px; font-weight: bold;">üéÆ Games</span>\n                        <span id="closeGamesMenu" style="color: #ffffff; font-size: 20px; cursor: pointer; font-weight: bold;">√ó</span>\n                    </div>\n                    \n                    \x3c!-- Games Grid --\x3e\n                    <div id="gamesGrid" style="padding: 20px; max-height: 400px; overflow-y: auto; display: grid; grid-template-columns: repeat(auto-fill, minmax(150px, 1fr)); gap: 15px;">\n                        \x3c!-- Games will be loaded here --\x3e\n                    </div>\n                    \n                    \x3c!-- Active Game Area --\x3e\n                    <div id="activeGameArea" style="padding: 15px 20px; border-top: 1px solid #444444; background: #1a1a1a; display: none;">\n                        <div id="activeGameContent">\n                            \x3c!-- Active game content will be loaded here --\x3e\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.gamesMenu),document.getElementById("closeGamesMenu").onclick=()=>{this.elements.gamesMenu.style.display="none",this.activeGame&&this.endGame()},this.elements.gamesMenu.onclick=e=>{e.target===this.elements.gamesMenu&&(this.elements.gamesMenu.style.display="none",this.activeGame&&this.endGame())}),this.loadGames(),this.displayGames(),this.elements.gamesMenu.style.display="flex"}displayGames(){const e=document.getElementById("gamesGrid");e.innerHTML="",this.games.forEach(t=>{const n=document.createElement("div");n.style.cssText="\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                padding: 15px;\n                border: 2px solid #444444;\n                border-radius: 8px;\n                cursor: pointer;\n                transition: all 0.3s ease;\n                background: #333333;\n                text-align: center;\n            ",n.innerHTML=`\n                <div style="font-size: 32px; margin-bottom: 10px;">${t.icon}</div>\n                <div style="font-size: 14px; font-weight: bold; margin-bottom: 5px; color: #ffffff;">${t.name}</div>\n                <div style="font-size: 11px; color: #cccccc;">${t.description}</div>\n            `,n.onclick=()=>{this.startGame(t)},n.onmouseover=()=>{n.style.borderColor="#0066cc",n.style.background="#444444"},n.onmouseout=()=>{n.style.borderColor="#444444",n.style.background="#333333"},e.appendChild(n)})}startGame(e){console.log("üé≠ [CLIENT] Starting game:",e),this.activeGame=e;const t=document.getElementById("activeGameArea"),n=document.getElementById("activeGameContent");switch(t.style.display="block",this.gameStates.set(e.id,{players:[],status:"waiting",startTime:Date.now(),data:{}}),e.id){case"doodle":this.loadDoodleGame(n);break;case"hangman":this.loadHangmanGame(n);break;case"tictactoe":this.loadTicTacToeGame(n);break;case"quiz":this.loadQuizGame(n);break;case"rps":this.loadRockPaperScissorsGame(n);break;case"dice":this.loadDiceGame(n);break;default:n.innerHTML=`<div style="text-align: center; padding: 20px;">Game ${e.name} coming soon!</div>`}this.socket&&this.socket.emit("start_game",{gameId:e.id,room:this.config.roomName,player:this.currentUser?this.currentUser.nickname:"Guest"})}endGame(){this.activeGame&&(console.log("üé≠ [CLIENT] Ending game:",this.activeGame),this.socket&&this.socket.emit("end_game",{gameId:this.activeGame.id}),this.activeGame=null,document.getElementById("activeGameArea").style.display="none")}loadDoodleGame(e){e.innerHTML='\n            <div style="text-align: center;">\n                <h3 style="margin-bottom: 15px;">üé® Doodle Game</h3>\n                <canvas id="doodleCanvas" width="400" height="300" style="border: 2px solid #444444; background: #ffffff; cursor: crosshair;"></canvas>\n                <div style="margin-top: 10px;">\n                    <button id="clearCanvas" style="background: #dc3545; border: none; color: #ffffff; padding: 8px 15px; border-radius: 4px; cursor: pointer; margin-right: 10px;">Clear</button>\n                    <button id="saveDoodle" style="background: #0066cc; border: none; color: #ffffff; padding: 8px 15px; border-radius: 4px; cursor: pointer;">Save</button>\n                </div>\n            </div>\n        ';const t=document.getElementById("doodleCanvas"),n=t.getContext("2d");let o=!1;t.onmousedown=()=>o=!0,t.onmouseup=()=>o=!1,t.onmouseleave=()=>o=!1,t.onmousemove=e=>{if(!o)return;const a=t.getBoundingClientRect(),s=e.clientX-a.left,i=e.clientY-a.top;n.lineWidth=2,n.lineCap="round",n.strokeStyle="#000000",n.lineTo(s,i),n.stroke(),n.beginPath(),n.moveTo(s,i)},document.getElementById("clearCanvas").onclick=()=>{n.clearRect(0,0,t.width,t.height)},document.getElementById("saveDoodle").onclick=()=>{const e=t.toDataURL();console.log("üé≠ [CLIENT] Doodle saved:",e),alert("Doodle saved! (This would upload to server in full implementation)")}}loadHangmanGame(e){e.innerHTML='\n            <div style="text-align: center;">\n                <h3 style="margin-bottom: 15px;">üéØ Hangman</h3>\n                <div id="hangmanWord" style="font-size: 24px; font-weight: bold; margin-bottom: 15px; letter-spacing: 5px;">_ _ _ _ _</div>\n                <div id="hangmanLives" style="margin-bottom: 15px;">Lives: 6</div>\n                <div id="hangmanGuessed" style="margin-bottom: 15px;">Guessed: </div>\n                <input type="text" id="hangmanGuess" placeholder="Enter a letter" style="padding: 8px; border: 1px solid #444444; border-radius: 4px; background: #333333; color: #ffffff; margin-right: 10px;">\n                <button id="submitGuess" style="background: #0066cc; border: none; color: #ffffff; padding: 8px 15px; border-radius: 4px; cursor: pointer;">Guess</button>\n            </div>\n        ';const t=["CHAT","GAME","FUN","PLAY","WIN"],n=t[Math.floor(Math.random()*t.length)];let o=new Set,a=6;document.getElementById("submitGuess").onclick=()=>{const e=document.getElementById("hangmanGuess").value.toUpperCase();if(e&&1===e.length){o.add(e),n.includes(e)||a--;const t=n.split("").map(e=>o.has(e)?e:"_").join(" ");document.getElementById("hangmanWord").textContent=t,document.getElementById("hangmanLives").textContent=`Lives: ${a}`,document.getElementById("hangmanGuessed").textContent=`Guessed: ${Array.from(o).join(", ")}`,document.getElementById("hangmanGuess").value="",a<=0?alert(`Game Over! The word was: ${n}`):t.includes("_")||alert("Congratulations! You won!")}}}loadTicTacToeGame(e){e.innerHTML=`\n            <div style="text-align: center;">\n                <h3 style="margin-bottom: 15px;">‚≠ï Tic Tac Toe</h3>\n                <div id="tictactoeBoard" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 5px; width: 150px; margin: 0 auto 15px auto;">\n                    ${Array(9).fill().map((e,t)=>`<div class="tictactoeCell" data-index="${t}" style="width: 50px; height: 50px; border: 2px solid #444444; display: flex; align-items: center; justify-content: center; font-size: 24px; cursor: pointer; background: #333333;"></div>`).join("")}\n                </div>\n                <button id="resetTicTacToe" style="background: #0066cc; border: none; color: #ffffff; padding: 8px 15px; border-radius: 4px; cursor: pointer;">Reset Game</button>\n            </div>\n        `;let t=Array(9).fill(""),n="X";document.querySelectorAll(".tictactoeCell").forEach(e=>{e.onclick=()=>{const o=parseInt(e.dataset.index);""===t[o]&&(t[o]=n,e.textContent=n,e.style.color="X"===n?"#ff0000":"#0000ff",this.checkTicTacToeWin(t,n)?(alert(`${n} wins!`),this.resetTicTacToe()):t.every(e=>""!==e)?(alert("It's a tie!"),this.resetTicTacToe()):n="X"===n?"O":"X")}}),document.getElementById("resetTicTacToe").onclick=()=>{this.resetTicTacToe()}}checkTicTacToeWin(e,t){return[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]].some(n=>n.every(n=>e[n]===t))}resetTicTacToe(){board=Array(9).fill(""),currentPlayer="X",document.querySelectorAll(".tictactoeCell").forEach(e=>{e.textContent="",e.style.color="#ffffff"})}loadQuizGame(e){e.innerHTML='\n            <div style="text-align: center;">\n                <h3 style="margin-bottom: 15px;">‚ùì Quiz</h3>\n                <div id="quizQuestion" style="margin-bottom: 15px; font-size: 16px;">Loading question...</div>\n                <div id="quizAnswers" style="display: grid; grid-template-columns: 1fr; gap: 10px; margin-bottom: 15px;">\n                    \x3c!-- Answers will be loaded here --\x3e\n                </div>\n                <div id="quizScore" style="margin-bottom: 15px;">Score: 0</div>\n            </div>\n        ';const t=[{question:"What is the capital of France?",answers:["London","Berlin","Paris","Madrid"],correct:2},{question:"Which planet is closest to the Sun?",answers:["Venus","Mercury","Earth","Mars"],correct:1},{question:"What is 2 + 2?",answers:["3","4","5","6"],correct:1}];let n=0,o=0;const a=()=>{const e=t[n];document.getElementById("quizQuestion").textContent=e.question,document.getElementById("quizAnswers").innerHTML=e.answers.map((e,t)=>`<button class="quizAnswer" data-index="${t}" style="background: #333333; border: 1px solid #444444; color: #ffffff; padding: 10px; border-radius: 4px; cursor: pointer;">${e}</button>`).join(""),document.querySelectorAll(".quizAnswer").forEach(s=>{s.onclick=()=>{parseInt(s.dataset.index)===e.correct?(o++,s.style.background="#28a745"):s.style.background="#dc3545",document.getElementById("quizScore").textContent=`Score: ${o}`,setTimeout(()=>{n++,n<t.length?a():alert(`Quiz complete! Final score: ${o}/${t.length}`)},1e3)}})};a()}loadRockPaperScissorsGame(e){e.innerHTML='\n            <div style="text-align: center;">\n                <h3 style="margin-bottom: 15px;">‚úÇÔ∏è Rock Paper Scissors</h3>\n                <div id="rpsResult" style="margin-bottom: 15px; font-size: 18px;">Choose your move!</div>\n                <div style="display: flex; gap: 10px; justify-content: center; margin-bottom: 15px;">\n                    <button class="rpsChoice" data-choice="rock" style="background: #333333; border: 1px solid #444444; color: #ffffff; padding: 15px; border-radius: 4px; cursor: pointer; font-size: 24px;">ü™®</button>\n                    <button class="rpsChoice" data-choice="paper" style="background: #333333; border: 1px solid #444444; color: #ffffff; padding: 15px; border-radius: 4px; cursor: pointer; font-size: 24px;">üìÑ</button>\n                    <button class="rpsChoice" data-choice="scissors" style="background: #333333; border: 1px solid #444444; color: #ffffff; padding: 15px; border-radius: 4px; cursor: pointer; font-size: 24px;">‚úÇÔ∏è</button>\n                </div>\n                <div id="rpsScore" style="margin-bottom: 15px;">Wins: 0 | Losses: 0 | Ties: 0</div>\n            </div>\n        ';let t=0,n=0,o=0;document.querySelectorAll(".rpsChoice").forEach(e=>{e.onclick=()=>{const a=e.dataset.choice,s=["rock","paper","scissors"][Math.floor(3*Math.random())];let i;a===s?(i="Tie!",o++):"rock"===a&&"scissors"===s||"paper"===a&&"rock"===s||"scissors"===a&&"paper"===s?(i="You win!",t++):(i="Computer wins!",n++),document.getElementById("rpsResult").textContent=`You chose ${a}, computer chose ${s}. ${i}`,document.getElementById("rpsScore").textContent=`Wins: ${t} | Losses: ${n} | Ties: ${o}`}})}loadDiceGame(e){e.innerHTML='\n            <div style="text-align: center;">\n                <h3 style="margin-bottom: 15px;">üé≤ Dice Roll</h3>\n                <div id="diceResult" style="font-size: 48px; margin-bottom: 15px;">‚öÄ</div>\n                <button id="rollDice" style="background: #0066cc; border: none; color: #ffffff; padding: 10px 20px; border-radius: 4px; cursor: pointer; margin-right: 10px;">Roll Dice</button>\n                <button id="rollMultiple" style="background: #28a745; border: none; color: #ffffff; padding: 10px 20px; border-radius: 4px; cursor: pointer;">Roll 5 Dice</button>\n                <div id="diceHistory" style="margin-top: 15px; font-size: 14px; color: #cccccc;"></div>\n            </div>\n        ';const t=["‚öÄ","‚öÅ","‚öÇ","‚öÉ","‚öÑ","‚öÖ"];let n=[];const o=()=>{const e=Math.floor(6*Math.random());return{face:t[e],value:e+1}};document.getElementById("rollDice").onclick=()=>{const e=o();document.getElementById("diceResult").textContent=e.face,n.push(e.value),document.getElementById("diceHistory").textContent=`History: ${n.slice(-5).join(", ")}`},document.getElementById("rollMultiple").onclick=()=>{const e=[];for(let t=0;t<5;t++)e.push(o());document.getElementById("diceResult").textContent=e.map(e=>e.face).join(" "),e.forEach(e=>n.push(e.value)),document.getElementById("diceHistory").textContent=`History: ${n.slice(-10).join(", ")}`}}addMessage(e){const t=document.createElement("div");t.style.cssText="\n            margin-bottom: 5px;\n            padding: 5px;\n            background: rgba(0, 0, 0, 0.5);\n            border-radius: 3px;\n            color: #ffffff;\n        ";const n=new Date(e.timestamp).toLocaleTimeString();t.innerHTML=`\n            <span style="color: #ffcc00; font-weight: bold;">${e.user.nickname}</span>\n            <span style="color: #666666; margin-left: 5px;">${n}</span>\n            <div style="margin-top: 2px;">${e.message}</div>\n        `,this.elements.chatArea.appendChild(t),this.elements.chatArea.scrollTop=this.elements.chatArea.scrollHeight}updateUserList(e){this.elements.userList.innerHTML="",this.users.clear(),e.forEach(e=>{this.addUser(e)}),this.elements.userCount&&(this.elements.userCount.textContent=`Users: ${e.length}`)}addUser(e){const t=document.createElement("div");t.className="user-item",t.dataset.userId=e.id,t.style.cssText="\n            display: flex;\n            align-items: center;\n            padding: 4px 6px;\n            margin: 1px 0;\n            background: rgba(0, 0, 0, 0.3);\n            border: 1px solid transparent;\n            border-radius: 3px;\n            cursor: pointer;\n            transition: all 0.2s ease;\n        ";const n=this.getUserColor(e.rank),o=this.getRankText(e.rank);t.innerHTML=`\n            <span style="color: #${n}; font-weight: bold; margin-right: 5px;">‚óè</span>\n            <img src="/avatars/${e.avatar}.png" style="width: 20px; height: 20px; border-radius: 2px; margin-right: 6px; border: 1px solid #333;">\n            <div style="flex: 1;">\n                <div style="color: #ffffff; font-weight: bold; font-size: 11px;">${e.nickname||e.username}</div>\n                <div style="color: #${n}; font-size: 9px;">${o}</div>\n            </div>\n        `,t.onmouseover=()=>{t.style.background="linear-gradient(to right, rgba(0, 102, 204, 0.3), rgba(0, 102, 204, 0.1))",t.style.borderColor="#0066cc",t.style.transform="translateX(2px)"},t.onmouseout=()=>{t.style.background="rgba(0, 0, 0, 0.3)",t.style.borderColor="transparent",t.style.transform="translateX(0)"},t.onclick=()=>this.showUserProfile(e),this.elements.userList.appendChild(t),this.users.set(e.id,t)}getUserColor(e){return{0:"cccccc",1:"ffffff",2:"00ff00",3:"ff0000",4:"ffff00"}[e]||"cccccc"}getRankText(e){return{0:"Guest",1:"Member",2:"Owner",3:"Admin",4:"Main Owner"}[e]||"Guest"}showUserProfile(e){switch(console.log("üé≠ [CLIENT] Showing profile for user:",e),this.getCurrentUserRank()){case"mainowner":this.showMainOwnerMenu(e);break;case"owner":this.showOwnerMenu(e);break;case"moderator":this.showModeratorMenu(e);break;case"regular":default:this.showRegularProfile(e);break;case"bot":this.showBotMenu(e)}}getCurrentUserRank(){const e=["mainowner","owner","moderator","member","guest","bot"],t=e[Math.floor(Math.random()*e.length)];return"guest"===t||"member"===t?"regular":t}showMainOwnerMenu(e){console.log("üé≠ [CLIENT] Showing main owner menu for user:",e),this.elements.mainOwnerModal||(this.elements.mainOwnerModal=document.createElement("div"),this.elements.mainOwnerModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.mainOwnerModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    \x3c!-- Title Bar --\x3e\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="mainOwnerTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ffffff; font-size: 14px; cursor: pointer;">‚öôÔ∏è</span>\n                            <span id="closeMainOwner" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- User Info Section --\x3e\n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        \x3c!-- Avatar --\x3e\n                        <img id="mainOwnerAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        \n                        \x3c!-- User Details --\x3e\n                        <div style="flex: 1;">\n                            <div id="mainOwnerUsername" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="mainOwnerStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                            <div id="mainOwnerFriendStatus" style="color: #cccccc; font-size: 11px;">Not added you as a friend</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Action Buttons Grid --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="main-owner-btn" data-action="privatechat" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>üí¨</span> Private Chat\n                            </button>\n                            <button class="main-owner-btn" data-action="privatemessage" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚úâÔ∏è</span> Private Message\n                            </button>\n                            <button class="main-owner-btn" data-action="addfriend" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">‚ûï</span> Add as Friend\n                            </button>\n                            <button class="main-owner-btn" data-action="ignore" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üö´</span> Ignore\n                            </button>\n                            <button class="main-owner-btn" data-action="kick" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #8b4513;">üë¢</span> Kick\n                            </button>\n                            <button class="main-owner-btn" data-action="ban" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚ùå</span> Ban\n                            </button>\n                            <button class="main-owner-btn" data-action="makeguest" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">üë§</span> Make Guest\n                            </button>\n                            <button class="main-owner-btn" data-action="makemember" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #0066cc;">üë§</span> Make Member\n                            </button>\n                            <button class="main-owner-btn" data-action="makemoderator" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ffffff;">üë§</span> Make Moderator\n                            </button>\n                            <button class="main-owner-btn" data-action="makeowner" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff8800;">üë§</span> Make Owner\n                            </button>\n                            <button class="main-owner-btn" data-action="divorce" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üíî</span> Divorce\n                            </button>\n                            <button class="main-owner-btn" data-action="transfer" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚¨ÖÔ∏è</span> Transfer\n                            </button>\n                            <button class="main-owner-btn" data-action="powers" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ffcc00;">‚ö°</span> Powers\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.mainOwnerModal),document.getElementById("closeMainOwner").onclick=()=>{this.elements.mainOwnerModal.style.display="none"},this.elements.mainOwnerModal.onclick=e=>{e.target===this.elements.mainOwnerModal&&(this.elements.mainOwnerModal.style.display="none")},document.querySelectorAll(".main-owner-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleMainOwnerAction(n,e)}})),document.getElementById("mainOwnerTitle").textContent=e.id,document.getElementById("mainOwnerAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("mainOwnerUsername").textContent=e.nickname||e.username,this.elements.mainOwnerModal.style.display="flex"}showRegularProfile(e){console.log("üé≠ [CLIENT] Showing regular profile for user:",e),this.elements.regularProfileModal||(this.elements.regularProfileModal=document.createElement("div"),this.elements.regularProfileModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.regularProfileModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    \x3c!-- Title Bar --\x3e\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="regularProfileTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ff4444; font-size: 14px; cursor: pointer;">üö´</span>\n                            <span id="closeRegularProfile" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- User Info Section --\x3e\n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        <img id="regularProfileAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        <div style="flex: 1;">\n                            <div id="regularProfileRank" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="regularProfileStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Action Buttons Grid (8 buttons - 2x4) --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="regular-profile-btn" data-action="privatechat" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>üí¨</span> Private Chat\n                            </button>\n                            <button class="regular-profile-btn" data-action="privatemessage" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚úâÔ∏è</span> Private Message\n                            </button>\n                            <button class="regular-profile-btn" data-action="addfriend" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">‚ûï</span> Add as Friend\n                            </button>\n                            <button class="regular-profile-btn" data-action="ignore" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üö´</span> Ignore\n                            </button>\n                            <button class="regular-profile-btn" data-action="marry" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚ù§Ô∏è</span> Marry/BFF\n                            </button>\n                            <button class="regular-profile-btn" data-action="transfer" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚û°Ô∏è</span> Transfer\n                            </button>\n                            <button class="regular-profile-btn" data-action="powers" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ffcc00;">‚ö°</span> Powers\n                            </button>\n                            <button class="regular-profile-btn" data-action="gifts" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üéÅ</span> Gifts\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.regularProfileModal),document.getElementById("closeRegularProfile").onclick=()=>{this.elements.regularProfileModal.style.display="none"},this.elements.regularProfileModal.onclick=e=>{e.target===this.elements.regularProfileModal&&(this.elements.regularProfileModal.style.display="none")},document.querySelectorAll(".regular-profile-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleRegularProfileAction(n,e)}})),document.getElementById("regularProfileTitle").textContent=`${e.nickname||e.username} (${e.id})`,document.getElementById("regularProfileAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("regularProfileRank").textContent=this.getRankText(e.rank),this.elements.regularProfileModal.style.display="flex"}showOwnerMenu(e){console.log("üé≠ [CLIENT] Showing owner menu for user:",e),this.elements.ownerModal||(this.elements.ownerModal=document.createElement("div"),this.elements.ownerModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.ownerModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    \x3c!-- Title Bar --\x3e\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="ownerTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ffffff; font-size: 14px; cursor: pointer;">‚öôÔ∏è</span>\n                            <span id="closeOwner" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- User Info Section --\x3e\n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        <img id="ownerAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        <div style="flex: 1;">\n                            <div id="ownerUsername" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="ownerStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                            <div id="ownerFriendStatus" style="color: #cccccc; font-size: 11px;">Not added you as a friend</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Action Buttons Grid (11 buttons - no transfer) --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="owner-btn" data-action="privatechat" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>üí¨</span> Private Chat\n                            </button>\n                            <button class="owner-btn" data-action="privatemessage" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚úâÔ∏è</span> Private Message\n                            </button>\n                            <button class="owner-btn" data-action="addfriend" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">‚ûï</span> Add as Friend\n                            </button>\n                            <button class="owner-btn" data-action="ignore" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üö´</span> Ignore\n                            </button>\n                            <button class="owner-btn" data-action="kick" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #8b4513;">üë¢</span> Kick\n                            </button>\n                            <button class="owner-btn" data-action="ban" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚ùå</span> Ban\n                            </button>\n                            <button class="owner-btn" data-action="makeguest" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">üë§</span> Make Guest\n                            </button>\n                            <button class="owner-btn" data-action="makemember" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #0066cc;">üë§</span> Make Member\n                            </button>\n                            <button class="owner-btn" data-action="makemoderator" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ffffff;">üë§</span> Make Moderator\n                            </button>\n                            <button class="owner-btn" data-action="makeowner" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff8800;">üë§</span> Make Owner\n                            </button>\n                            <button class="owner-btn" data-action="divorce" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üíî</span> Divorce\n                            </button>\n                            <button class="owner-btn" data-action="powers" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ffcc00;">‚ö°</span> Powers\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.ownerModal),document.getElementById("closeOwner").onclick=()=>{this.elements.ownerModal.style.display="none"},this.elements.ownerModal.onclick=e=>{e.target===this.elements.ownerModal&&(this.elements.ownerModal.style.display="none")},document.querySelectorAll(".owner-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleOwnerAction(n,e)}})),document.getElementById("ownerTitle").textContent=e.id,document.getElementById("ownerAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("ownerUsername").textContent=e.nickname||e.username,this.elements.ownerModal.style.display="flex"}showModeratorMenu(e){console.log("üé≠ [CLIENT] Showing moderator menu for user:",e),this.elements.moderatorModal||(this.elements.moderatorModal=document.createElement("div"),this.elements.moderatorModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.moderatorModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="moderatorTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ffffff; font-size: 14px; cursor: pointer;">‚öôÔ∏è</span>\n                            <span id="closeModerator" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        <img id="moderatorAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        <div style="flex: 1;">\n                            <div id="moderatorUsername" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="moderatorStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                            <div id="moderatorFriendStatus" style="color: #cccccc; font-size: 11px;">Not added you as a friend</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Moderator buttons (limited admin powers) --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="moderator-btn" data-action="privatechat" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>üí¨</span> Private Chat\n                            </button>\n                            <button class="moderator-btn" data-action="privatemessage" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚úâÔ∏è</span> Private Message\n                            </button>\n                            <button class="moderator-btn" data-action="addfriend" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">‚ûï</span> Add as Friend\n                            </button>\n                            <button class="moderator-btn" data-action="ignore" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üö´</span> Ignore\n                            </button>\n                            <button class="moderator-btn" data-action="kick" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #8b4513;">üë¢</span> Kick\n                            </button>\n                            <button class="moderator-btn" data-action="ban" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚ùå</span> Ban\n                            </button>\n                            <button class="moderator-btn" data-action="makeguest" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">üë§</span> Make Guest\n                            </button>\n                            <button class="moderator-btn" data-action="makemember" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #0066cc;">üë§</span> Make Member\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.moderatorModal),document.getElementById("closeModerator").onclick=()=>{this.elements.moderatorModal.style.display="none"},this.elements.moderatorModal.onclick=e=>{e.target===this.elements.moderatorModal&&(this.elements.moderatorModal.style.display="none")},document.querySelectorAll(".moderator-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleModeratorAction(n,e)}})),document.getElementById("moderatorTitle").textContent=e.id,document.getElementById("moderatorAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("moderatorUsername").textContent=e.nickname||e.username,this.elements.moderatorModal.style.display="flex"}showMemberMenu(e){console.log("üé≠ [CLIENT] Showing member menu for user:",e),this.elements.memberModal||(this.elements.memberModal=document.createElement("div"),this.elements.memberModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.memberModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="memberTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ffffff; font-size: 14px; cursor: pointer;">‚öôÔ∏è</span>\n                            <span id="closeMember" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        <img id="memberAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        <div style="flex: 1;">\n                            <div id="memberUsername" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="memberStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                            <div id="memberFriendStatus" style="color: #cccccc; font-size: 11px;">Not added you as a friend</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Member buttons (social only) --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="member-btn" data-action="privatechat" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>üí¨</span> Private Chat\n                            </button>\n                            <button class="member-btn" data-action="privatemessage" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚úâÔ∏è</span> Private Message\n                            </button>\n                            <button class="member-btn" data-action="addfriend" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">‚ûï</span> Add as Friend\n                            </button>\n                            <button class="member-btn" data-action="ignore" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">üö´</span> Ignore\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.memberModal),document.getElementById("closeMember").onclick=()=>{this.elements.memberModal.style.display="none"},this.elements.memberModal.onclick=e=>{e.target===this.elements.memberModal&&(this.elements.memberModal.style.display="none")},document.querySelectorAll(".member-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleMemberAction(n,e)}})),document.getElementById("memberTitle").textContent=e.id,document.getElementById("memberAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("memberUsername").textContent=e.nickname||e.username,this.elements.memberModal.style.display="flex"}showGuestMenu(e){console.log("üé≠ [CLIENT] Showing guest menu for user:",e),this.elements.guestModal||(this.elements.guestModal=document.createElement("div"),this.elements.guestModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.guestModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="guestTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ffffff; font-size: 14px; cursor: pointer;">‚öôÔ∏è</span>\n                            <span id="closeGuest" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        <img id="guestAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        <div style="flex: 1;">\n                            <div id="guestUsername" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="guestStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                            <div id="guestFriendStatus" style="color: #cccccc; font-size: 11px;">Not added you as a friend</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Guest buttons (minimal) --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="guest-btn" data-action="privatechat" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>üí¨</span> Private Chat\n                            </button>\n                            <button class="guest-btn" data-action="privatemessage" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚úâÔ∏è</span> Private Message\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.guestModal),document.getElementById("closeGuest").onclick=()=>{this.elements.guestModal.style.display="none"},this.elements.guestModal.onclick=e=>{e.target===this.elements.guestModal&&(this.elements.guestModal.style.display="none")},document.querySelectorAll(".guest-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleGuestAction(n,e)}})),document.getElementById("guestTitle").textContent=e.id,document.getElementById("guestAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("guestUsername").textContent=e.nickname||e.username,this.elements.guestModal.style.display="flex"}showBotMenu(e){console.log("üé≠ [CLIENT] Showing bot menu for user:",e),this.elements.botModal||(this.elements.botModal=document.createElement("div"),this.elements.botModal.style.cssText="\n                position: fixed;\n                top: 0;\n                left: 0;\n                width: 100%;\n                height: 100%;\n                background: rgba(0, 0, 0, 0.8);\n                display: none;\n                justify-content: center;\n                align-items: center;\n                z-index: 1000;\n            ",this.elements.botModal.innerHTML='\n                <div style="background: #2a2a2a; border: 1px solid #444444; border-radius: 4px; width: 350px; color: #ffffff; font-family: Arial, sans-serif; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.5);">\n                    <div style="background: #1a1a1a; padding: 8px 12px; border-bottom: 1px solid #444444; display: flex; justify-content: space-between; align-items: center;">\n                        <span id="botTitle" style="font-size: 14px; font-weight: bold; color: #ffffff;"></span>\n                        <div style="display: flex; gap: 10px;">\n                            <span style="color: #ffffff; font-size: 14px; cursor: pointer;">‚öôÔ∏è</span>\n                            <span id="closeBot" style="color: #ffffff; font-size: 16px; cursor: pointer; font-weight: bold;">√ó</span>\n                        </div>\n                    </div>\n                    \n                    <div style="padding: 15px; display: flex; align-items: flex-start;">\n                        <img id="botAvatar" src="" style="width: 50px; height: 50px; border: 1px solid #666666; margin-right: 15px;">\n                        <div style="flex: 1;">\n                            <div id="botUsername" style="font-size: 16px; font-weight: bold; color: #ffffff; margin-bottom: 5px;"></div>\n                            <div id="botStatus" style="color: #00ff00; font-size: 12px; margin-bottom: 3px;">Online</div>\n                            <div id="botType" style="color: #cccccc; font-size: 11px;">Bot Account</div>\n                        </div>\n                    </div>\n                    \n                    \x3c!-- Bot buttons (bot-specific) --\x3e\n                    <div style="padding: 0 15px 15px 15px;">\n                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px;">\n                            <button class="bot-btn" data-action="configure" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>‚öôÔ∏è</span> Configure Bot\n                            </button>\n                            <button class="bot-btn" data-action="responses" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span>ü§ñ</span> Set Responses\n                            </button>\n                            <button class="bot-btn" data-action="enable" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #00ff00;">‚úÖ</span> Enable Bot\n                            </button>\n                            <button class="bot-btn" data-action="disable" style="background: linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 100%); border: 1px solid #555555; color: #ffffff; padding: 8px; font-size: 11px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 5px;">\n                                <span style="color: #ff4444;">‚ùå</span> Disable Bot\n                            </button>\n                        </div>\n                    </div>\n                </div>\n            ',document.body.appendChild(this.elements.botModal),document.getElementById("closeBot").onclick=()=>{this.elements.botModal.style.display="none"},this.elements.botModal.onclick=e=>{e.target===this.elements.botModal&&(this.elements.botModal.style.display="none")},document.querySelectorAll(".bot-btn").forEach(t=>{t.onclick=t=>{const n=t.currentTarget.dataset.action;this.handleBotAction(n,e)}})),document.getElementById("botTitle").textContent=e.id,document.getElementById("botAvatar").src=`/avatars/${e.avatar}.png`,document.getElementById("botUsername").textContent=e.nickname||e.username,this.elements.botModal.style.display="flex"}handleProfileAction(e){switch(console.log("üé≠ [CLIENT] Profile action:",e),e){case"settings":alert("Settings functionality coming soon!");break;case"login":alert("Login functionality coming soon!");break;case"divorce":alert("Divorce functionality coming soon!");break;case"buyxats":alert("Buy xats functionality coming soon!");break;case"store":alert("xat Store functionality coming soon!");break;case"powers":alert("Powers functionality coming soon!");break;case"gifts":alert("Gifts functionality coming soon!");break;case"save":alert("Profile saved!")}}handleMainOwnerAction(e,t){switch(console.log("üé≠ [CLIENT] Main owner action:",e,"for user:",t),e){case"privatechat":this.startPrivateChat(t);break;case"privatemessage":this.sendPrivateMessage(t);break;case"addfriend":this.addAsFriend(t);break;case"ignore":this.ignoreUser(t);break;case"kick":this.kickUser(t);break;case"ban":this.banUser(t);break;case"makeguest":this.makeUserGuest(t);break;case"makemember":this.makeUserMember(t);break;case"makemoderator":this.makeUserModerator(t);break;case"makeowner":this.makeUserOwner(t);break;case"divorce":this.divorceUser(t);break;case"transfer":this.transferOwnership(t);break;case"powers":this.showUserPowers(t)}}handleOwnerAction(e,t){console.log("üé≠ [CLIENT] Owner action:",e,"for user:",t),this.handleMainOwnerAction(e,t)}handleModeratorAction(e,t){switch(console.log("üé≠ [CLIENT] Moderator action:",e,"for user:",t),e){case"privatechat":this.startPrivateChat(t);break;case"privatemessage":this.sendPrivateMessage(t);break;case"addfriend":this.addAsFriend(t);break;case"ignore":this.ignoreUser(t);break;case"kick":this.kickUser(t);break;case"ban":this.banUser(t);break;case"makeguest":this.makeUserGuest(t);break;case"makemember":this.makeUserMember(t);break;default:alert("Action not available for moderators!")}}handleMemberAction(e,t){switch(console.log("üé≠ [CLIENT] Member action:",e,"for user:",t),e){case"privatechat":this.startPrivateChat(t);break;case"privatemessage":this.sendPrivateMessage(t);break;case"addfriend":this.addAsFriend(t);break;case"ignore":this.ignoreUser(t);break;default:alert("Action not available for members!")}}handleGuestAction(e,t){switch(console.log("üé≠ [CLIENT] Guest action:",e,"for user:",t),e){case"privatechat":this.startPrivateChat(t);break;case"privatemessage":this.sendPrivateMessage(t);break;default:alert("Action not available for guests!")}}handleBotAction(e,t){switch(console.log("üé≠ [CLIENT] Bot action:",e,"for user:",t),e){case"configure":this.configureBot(t);break;case"responses":this.setBotResponses(t);break;case"enable":this.enableBot(t);break;case"disable":this.disableBot(t)}}configureBot(e){console.log("üé≠ [CLIENT] Configuring bot:",e),alert(`Bot configuration for ${e.nickname||e.username} - Coming soon!`)}setBotResponses(e){console.log("üé≠ [CLIENT] Setting bot responses:",e),alert(`Bot responses for ${e.nickname||e.username} - Coming soon!`)}enableBot(e){console.log("üé≠ [CLIENT] Enabling bot:",e),this.socket&&this.socket.emit("enable_bot",{targetUserId:e.id}),alert(`Bot ${e.nickname||e.username} has been enabled!`)}disableBot(e){console.log("üé≠ [CLIENT] Disabling bot:",e),this.socket&&this.socket.emit("disable_bot",{targetUserId:e.id}),alert(`Bot ${e.nickname||e.username} has been disabled!`)}insertSmiley(e){const t=this.elements.messageInput,n=t.selectionStart,o=t.selectionEnd,a=t.value;t.value=a.substring(0,n)+e+a.substring(o),t.selectionStart=t.selectionEnd=n+e.length,t.focus()}playRadio(){const e=document.getElementById("radioUrl")?.value;e&&console.log("üé≠ [CLIENT] Playing radio:",e)}stopRadio(){console.log("üé≠ [CLIENT] Stopping radio")}ask8Ball(){const e=document.getElementById("8ballQuestion")?.value;if(e){const e=["It is certain","It is decidedly so","Without a doubt","Yes definitely","Reply hazy, try again","Ask again later","Better not tell you now","Don't count on it","My reply is no","My sources say no"],t=e[Math.floor(Math.random()*e.length)];document.getElementById("8ballAnswer").textContent=t,this.socket&&this.socket.emit("message",{message:`8-Ball says: ${t}`})}}async loadPowers(){try{console.log("üé≠ [CLIENT] Loading powers from API...");const e=await fetch("/api/powers"),t=await e.json();return this.powers=t.powers||[],console.log("üé≠ [CLIENT] Loaded",this.powers.length,"powers"),this.powers}catch(e){return console.error("üé≠ [CLIENT] Error loading powers:",e),[]}}switchTab(e){console.log("üé≠ [CLIENT] Switching to tab:",e),this.currentTab=e,this.elements.header.querySelectorAll("[data-tab]").forEach(t=>{const n=t.dataset.tab===e;t.style.background=n?`linear-gradient(to bottom, ${t.dataset.color} 0%, ${t.dataset.color}80 50%, ${t.dataset.color}60 100%)`:"linear-gradient(to bottom, #3a3a3a 0%, #2a2a2a 50%, #1a1a1a 100%)",t.style.borderColor=n?t.dataset.color:"#555555",t.style.color=n?"#ffffff":"#cccccc"}),this.showTabContent(e)}showTabContent(e){switch(["chatArea","powersArea","smiliesArea"].forEach(e=>{this.elements[e]&&(this.elements[e].style.display="none")}),e){case"chat":this.elements.chatArea&&(this.elements.chatArea.style.display="block");break;case"powers":this.showPowersTab();break;case"smilies":this.showSmiliesTab()}}showPowersTab(){console.log("üé≠ [CLIENT] Showing powers tab..."),this.elements.powersArea||(this.elements.powersArea=document.createElement("div"),this.elements.powersArea.style.cssText="\n                position: absolute;\n                top: 30px;\n                left: 0;\n                right: 200px;\n                bottom: 85px;\n                background: rgba(0, 0, 0, 0.95);\n                border-right: 2px solid #ffcc00;\n                overflow-y: auto;\n                padding: 10px;\n                z-index: 5;\n                font-family: Arial, sans-serif;\n                font-size: 12px;\n                color: #ffffff;\n            ",this.container.appendChild(this.elements.powersArea)),this.elements.powersArea.style.display="block",this.elements.chatArea.style.display="none",this.displayPowers()}async displayPowers(){0===this.powers.length&&await this.loadPowers();const e=this.elements.powersArea;e.innerHTML=`\n            <div style="text-align: center; margin-bottom: 15px;">\n                <h2 style="color: #ffcc00; margin: 0; font-size: 18px;">‚ö° iXat Powers Store</h2>\n                <p style="color: #cccccc; margin: 5px 0;">${this.powers.length} authentic powers available</p>\n            </div>\n            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px;">\n        `,this.powers.forEach(t=>{const n=document.createElement("div");n.style.cssText="\n                background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 100%);\n                border: 2px solid #ffcc00;\n                border-radius: 8px;\n                padding: 10px;\n                text-align: center;\n                transition: all 0.3s ease;\n                cursor: pointer;\n            ",n.innerHTML=`\n                <div style="font-size: 24px; margin-bottom: 5px;">‚ö°</div>\n                <div style="font-weight: bold; color: #ffcc00; margin-bottom: 5px;">${t.name}</div>\n                <div style="color: #cccccc; font-size: 11px; margin-bottom: 8px;">${t.cost} xats</div>\n                <div style="color: #999999; font-size: 10px; line-height: 1.3;">${t.description.substring(0,80)}${t.description.length>80?"...":""}</div>\n                <button onclick="window.ixatClient.buyPower('${t.name}')" style="\n                    background: linear-gradient(to bottom, #ffcc00 0%, #ffaa00 100%);\n                    border: none;\n                    border-radius: 4px;\n                    color: #000000;\n                    padding: 5px 15px;\n                    font-weight: bold;\n                    cursor: pointer;\n                    margin-top: 8px;\n                    font-size: 11px;\n                ">Buy Power</button>\n            `,n.onmouseover=()=>{n.style.transform="translateY(-2px)",n.style.boxShadow="0 4px 8px rgba(255, 204, 0, 0.3)"},n.onmouseout=()=>{n.style.transform="translateY(0)",n.style.boxShadow="none"},e.appendChild(n)}),e.innerHTML+="</div>"}async buyPower(e){console.log("üé≠ [CLIENT] Attempting to buy power:",e);try{const t=await fetch("/api/powers/buy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({powerName:e,userId:this.currentUser?.id||"guest"})}),n=await t.json();n.success?(console.log("üé≠ [CLIENT] Power purchased successfully:",n.message),alert(`‚úÖ ${n.message}\n\nPower: ${n.power.name}\nCost: ${n.power.cost} xats\n\nDescription: ${n.power.description}`)):(console.error("üé≠ [CLIENT] Power purchase failed:",n.message),alert(`‚ùå Purchase failed: ${n.message}`))}catch(e){console.error("üé≠ [CLIENT] Error buying power:",e),alert("‚ùå Error: Could not connect to server. Please try again.")}}showSmiliesTab(){console.log("üé≠ [CLIENT] Showing smilies tab..."),this.elements.smiliesArea||(this.elements.smiliesArea=document.createElement("div"),this.elements.smiliesArea.style.cssText="\n                position: absolute;\n                top: 30px;\n                left: 0;\n                right: 200px;\n                bottom: 85px;\n                background: rgba(0, 0, 0, 0.95);\n                border-right: 2px solid #ff9900;\n                overflow-y: auto;\n                padding: 10px;\n                z-index: 5;\n                font-family: Arial, sans-serif;\n                font-size: 12px;\n                color: #ffffff;\n            ",this.container.appendChild(this.elements.smiliesArea)),this.elements.smiliesArea.style.display="block",this.elements.chatArea.style.display="none",this.elements.smiliesArea.innerHTML='\n            <div style="text-align: center; margin-bottom: 15px;">\n                <h2 style="color: #ff9900; margin: 0; font-size: 18px;">üòä Smilies</h2>\n                <p style="color: #cccccc; margin: 5px 0;">Click a smiley to add it to your message</p>\n            </div>\n            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(40px, 1fr)); gap: 5px; padding: 10px;">\n        ',["üòä","üòÇ","üòç","üòé","üò¢","üò°","üò¥","üòá","ü§î","üòã","üòò","üòú","üòÅ","üòÑ","üòÖ","üòÜ","üòâ","üòå","üòç","üòò","üòó","üòô","üòö","üòã","üòõ","üòù","üòú","üòé","üòè","üòí","üòû","üòî","üòü","üòï","üôÅ","‚òπÔ∏è","üò£","üòñ","üò´","üò©","üò§","üò†","üò°","üò∂","üòê","üòë","üòØ","üò¶","üòß","üòÆ","üò≤","üò¥","üòµ","üò≥","üò±","üò®","üò∞","üò¢","üò•","üò≠","üòì","üò™","üò∑","ü§í","ü§ï","ü§¢","ü§ß","üòà","üëø","üëπ","üë∫","üíÄ","üëª","üëΩ","ü§ñ","üí©","üò∫","üò∏","üòπ","üòª","üòº","üòΩ","üôÄ","üòø","üòæ"].forEach(e=>{const t=document.createElement("div");t.textContent=e,t.style.cssText="\n                font-size: 24px;\n                text-align: center;\n                padding: 5px;\n                cursor: pointer;\n                border-radius: 3px;\n                transition: all 0.2s ease;\n            ",t.onmouseover=()=>{t.style.background="rgba(255, 153, 0, 0.3)",t.style.transform="scale(1.2)"},t.onmouseout=()=>{t.style.background="transparent",t.style.transform="scale(1)"},t.onclick=()=>this.insertSmiley(e),this.elements.smiliesArea.appendChild(t)}),this.elements.smiliesArea.innerHTML+="</div>"}switchRankPool(e){console.log("üé≠ [CLIENT] Switching to rank pool:",e)}switchChatGroup(e){console.log("üé≠ [CLIENT] Switching chat group to:",e),this.currentChatGroup=e;const t=this.chatGroups.find(t=>t.id===e),n=this.elements.header.querySelector("div");n&&(n.innerHTML=`\n                <span style="font-size: 16px; margin-right: 8px;">ü™ê</span>\n                ${t?t.name:"Chat"}\n            `),this.elements.leftSidebar.querySelectorAll("div").forEach(e=>{e.textContent&&this.chatGroups.some(t=>t.name===e.textContent)&&(e.textContent===t.name?(e.style.background="#28a745",e.style.borderColor="#28a745"):(e.style.background="#333333",e.style.borderColor="#444444"))}),this.elements.chatArea.innerHTML="",this.addMessage({type:"system",text:`Welcome to ${t.name}!`,timestamp:new Date}),this.socket&&this.socket.emit("switch_room",{roomId:e}),console.log("üé≠ [CLIENT] Switched to chat group:",t.name)}}window.createIxatChat=function(e,t){console.log("üé≠ [GLOBAL] createIxatChat called with containerId:",e),console.log("üé≠ [GLOBAL] Config:",t),console.log("üé≠ [GLOBAL] Container element exists:",!!document.getElementById(e));try{const n=new IxatClient(e,t);return window.ixatClient=n,console.log("üé≠ [GLOBAL] Client created successfully:",n),n}catch(e){throw console.error("üé≠ [GLOBAL] Error creating client:",e),e}},console.log("üé≠ [GLOBAL] createIxatChat function available:",typeof window.createIxatChat);