(()=>{"use strict";var e,t={500:(e,t,n)=>{var o=n(496);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function s(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,a(o.key),o)}}function a(e){var t=function(e){if("object"!=i(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==i(t)?t:t+""}var r=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.socket=null,this.currentRoom=null,this.user=null,this.isTyping=!1,this.typingTimeout=null,this.initializeElements(),this.initializeSocket(),this.bindEvents(),this.loadUserData()},t=[{key:"initializeElements",value:function(){this.chatContainer=document.getElementById("chat-container"),this.messageList=document.getElementById("message-list"),this.messageInput=document.getElementById("message-input"),this.sendButton=document.getElementById("send-button"),this.roomInfo=document.getElementById("room-info"),this.userList=document.getElementById("user-list"),this.typingIndicator=document.getElementById("typing-indicator"),this.roomSelect=document.getElementById("room-select"),this.avatarSelect=document.getElementById("avatar-select"),this.powerSelect=document.getElementById("power-select")}},{key:"initializeSocket",value:function(){var e=this;this.socket=(0,o.Ay)(),this.socket.on("connect",function(){console.log("Connected to server"),e.updateConnectionStatus("Connected")}),this.socket.on("disconnect",function(){console.log("Disconnected from server"),e.updateConnectionStatus("Disconnected")}),this.socket.on("message:received",function(t){e.displayMessage(t)}),this.socket.on("user:join",function(t){e.handleUserJoin(t)}),this.socket.on("user:leave",function(t){e.handleUserLeave(t)}),this.socket.on("typing:start",function(t){e.showTypingIndicator(t.userId)}),this.socket.on("typing:stop",function(t){e.hideTypingIndicator(t.userId)}),this.socket.on("power:effect",function(t){e.handlePowerEffect(t)})}},{key:"bindEvents",value:function(){var e=this;this.sendButton.addEventListener("click",function(){e.sendMessage()}),this.messageInput.addEventListener("keypress",function(t){"Enter"!==t.key||t.shiftKey||(t.preventDefault(),e.sendMessage())}),this.messageInput.addEventListener("input",function(){e.handleTyping()}),this.roomSelect.addEventListener("change",function(t){e.joinRoom(t.target.value)}),this.avatarSelect.addEventListener("change",function(t){e.changeAvatar(t.target.value)}),this.powerSelect.addEventListener("change",function(t){e.activatePower(t.target.value)})}},{key:"loadUserData",value:function(){var e=localStorage.getItem("user");e?(this.user=JSON.parse(e),this.updateUserInfo()):window.location.href="/"}},{key:"sendMessage",value:function(){var e=this.messageInput.value.trim();if(e&&this.currentRoom){var t={roomId:this.currentRoom,content:e,type:"text"};this.socket.emit("message:send",t),this.messageInput.value="",this.stopTyping()}}},{key:"displayMessage",value:function(e){var t=document.createElement("div");t.className="message";var n=new Date(e.timestamp).toLocaleTimeString();t.innerHTML='\n      <div class="message-header">\n        <span class="username">'.concat(e.username||"Anonymous",'</span>\n        <span class="timestamp">').concat(n,'</span>\n      </div>\n      <div class="message-content">').concat(this.escapeHtml(e.content),"</div>\n    "),this.messageList.appendChild(t),this.scrollToBottom()}},{key:"handleUserJoin",value:function(e){var t=document.createElement("div");t.className="system-message join",t.textContent="".concat(e.username||"Anonymous"," joined the room"),this.messageList.appendChild(t),this.scrollToBottom(),this.updateUserList()}},{key:"handleUserLeave",value:function(e){var t=document.createElement("div");t.className="system-message leave",t.textContent="".concat(e.username||"Anonymous"," left the room"),this.messageList.appendChild(t),this.scrollToBottom(),this.updateUserList()}},{key:"joinRoom",value:function(e){this.currentRoom&&this.socket.emit("room:leave",this.currentRoom),this.currentRoom=e,this.socket.emit("room:join",e),this.messageList.innerHTML="",this.updateRoomInfo(e)}},{key:"handleTyping",value:function(){var e=this;this.isTyping||(this.isTyping=!0,this.socket.emit("typing:start",this.currentRoom)),clearTimeout(this.typingTimeout),this.typingTimeout=setTimeout(function(){e.stopTyping()},3e3)}},{key:"stopTyping",value:function(){this.isTyping&&(this.isTyping=!1,this.socket.emit("typing:stop",this.currentRoom))}},{key:"showTypingIndicator",value:function(e){e!==this.socket.id&&(this.typingIndicator.textContent="Someone is typing...",this.typingIndicator.style.display="block")}},{key:"hideTypingIndicator",value:function(e){e!==this.socket.id&&(this.typingIndicator.style.display="none")}},{key:"changeAvatar",value:function(e){this.socket.emit("avatar:change",{avatarId:e})}},{key:"activatePower",value:function(e){this.currentRoom&&this.socket.emit("power:activate",{roomId:this.currentRoom,powerId:e})}},{key:"handlePowerEffect",value:function(e){console.log("Power effect:",e),e.sound&&this.playSound(e.sound),e.animation&&this.showAnimation(e.animation)}},{key:"playSound",value:function(e){new Audio("/sounds/".concat(e)).play().catch(function(e){return console.log("Audio play failed:",e)})}},{key:"showAnimation",value:function(e){var t=document.createElement("div");t.className="power-animation ".concat(e),this.chatContainer.appendChild(t),setTimeout(function(){t.remove()},3e3)}},{key:"updateConnectionStatus",value:function(e){var t=document.getElementById("connection-status");t&&(t.textContent=e,t.className="status ".concat(e.toLowerCase()))}},{key:"updateUserInfo",value:function(){var e=document.getElementById("user-info");e&&this.user&&(e.innerHTML='\n        <span class="username">'.concat(this.user.username,'</span>\n        <span class="level">Level ').concat(this.user.level||1,"</span>\n      "))}},{key:"updateRoomInfo",value:function(e){this.roomInfo&&(this.roomInfo.innerHTML="\n        <h3>Room: ".concat(e,'</h3>\n        <span class="user-count">0 users</span>\n      '))}},{key:"updateUserList",value:function(){this.userList&&(this.userList.innerHTML='<div class="user-item">Loading users...</div>')}},{key:"scrollToBottom",value:function(){this.messageList.scrollTop=this.messageList.scrollHeight}},{key:"escapeHtml",value:function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML}}],t&&s(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t}();document.addEventListener("DOMContentLoaded",function(){new r})}},n={};function o(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}};return t[e](s,s.exports,o),s.exports}o.m=t,e=[],o.O=(t,n,i,s)=>{if(!n){var a=1/0;for(l=0;l<e.length;l++){for(var[n,i,s]=e[l],r=!0,c=0;c<n.length;c++)(!1&s||a>=s)&&Object.keys(o.O).every(e=>o.O[e](n[c]))?n.splice(c--,1):(r=!1,s<a&&(a=s));if(r){e.splice(l--,1);var u=i();void 0!==u&&(t=u)}}return t}s=s||0;for(var l=e.length;l>0&&e[l-1][2]>s;l--)e[l]=e[l-1];e[l]=[n,i,s]},o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.j=377,(()=>{var e={377:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var i,s,[a,r,c]=n,u=0;if(a.some(t=>0!==e[t])){for(i in r)o.o(r,i)&&(o.m[i]=r[i]);if(c)var l=c(o)}for(t&&t(n);u<a.length;u++)s=a[u],o.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return o.O(l)},n=self.webpackChunkxat_recreation=self.webpackChunkxat_recreation||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var i=o.O(void 0,[96],()=>o(500));i=o.O(i)})();
//# sourceMappingURL=chat.833f4f2017c90dac3743.js.map